<div class="session-tabs-container">
  <!-- New Chat Button -->
  <button
    class="session-tab new-chat-tab"
    (click)="handleNewChat($event)"
    [attr.aria-label]="'New Chat'"
    type="button"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="new-chat-icon"
    >
      <line x1="12" y1="5" x2="12" y2="19" />
      <line x1="5" y1="12" x2="19" y2="12" />
    </svg>
    <span class="session-name">新建</span>
  </button>

  <!-- Session Tabs -->
  @for (session of sortedSessions(); track session.id) {
    <button
      [class.active]="session.id === activeSessionId()"
      [class.status-processing]="session.status === 'processing'"
      [class.status-disconnected]="session.status === 'disconnected'"
      [class]="getSessionColorClass(session)"
      (click)="handleSessionClick($event, session.id)"
      [uiContextMenuTrigger]="getSessionMenuItems(session.id)"
      [title]="session.name"
      class="session-tab"
      [attr.aria-label]="'Switch to ' + session.name"
      [attr.aria-selected]="session.id === activeSessionId()"
      type="button"
    >
      @if (session.status === 'processing') {
        <!-- Processing: 加载图标 -->
        <svg
          class="status-icon processing-icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2.5"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <path
            d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"
          />
        </svg>
      } @else if (session.status === 'disconnected') {
        <!-- Disconnected: 警告图标 -->
        <svg
          class="status-icon disconnected-icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <path
            d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"
          />
          <line x1="12" y1="9" x2="12" y2="13" />
          <line x1="12" y1="17" x2="12.01" y2="17" />
        </svg>
      } @else {
        <!-- Idle: 正常/勾选图标 -->
        <svg
          class="status-icon idle-icon"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <polyline points="20 6 9 17 4 12" />
        </svg>
      }
      <span class="session-name" [attr.title]="session.name">{{ session.name }}</span>
    </button>
  }
</div>
